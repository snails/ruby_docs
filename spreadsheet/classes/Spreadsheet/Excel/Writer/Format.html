<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>Spreadsheet::Excel::Writer::Format</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="../../../../css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../../../css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../../../css/github.css" type="text/css" media="screen" />
<script src="../../../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../../../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
<script src="../../../../js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="../../../../js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>

</head>

<body>     
    <div class="banner">
        
        <h1>
            <span class="type">Class</span> 
            Spreadsheet::Excel::Writer::Format 
            
                <span class="parent">&lt; 
                    
                    DelegateClassSpreadsheet::Format
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../../../files/spreadsheet/lib/spreadsheet/excel/writer/format_rb.html">spreadsheet/lib/spreadsheet/excel/writer/format.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<p>This class encapsulates everything that is needed to write an XF record.</p>

    </div>
  


  


  
  


  


  
    <!-- Method ref -->
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
      
        <dt>B</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-boolean">boolean</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>C</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-color">color</a>,
              </li>
            
              
              <li>
                <a href="#method-i-color_code">color_code</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>F</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-font_index">font_index</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>H</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-horizontal_align">horizontal_align</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>N</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-new">new</a>,
              </li>
            
              
              <li>
                <a href="#method-i-num_format">num_format</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>T</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-text_direction">text_direction</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>V</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-vertical_align">vertical_align</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>W</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-write_op">write_op</a>,
              </li>
            
              
              <li>
                <a href="#method-i-write_xf">write_xf</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>X</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-xf_align">xf_align</a>,
              </li>
            
              
              <li>
                <a href="#method-i-xf_borders">xf_borders</a>,
              </li>
            
              
              <li>
                <a href="#method-i-xf_brdcolors">xf_brdcolors</a>,
              </li>
            
              
              <li>
                <a href="#method-i-xf_indent">xf_indent</a>,
              </li>
            
              
              <li>
                <a href="#method-i-xf_pattern">xf_pattern</a>,
              </li>
            
              
              <li>
                <a href="#method-i-xf_rotation">xf_rotation</a>,
              </li>
            
              
              <li>
                <a href="#method-i-xf_type_prot">xf_type_prot</a>,
              </li>
            
              
              <li>
                <a href="#method-i-xf_used_attr">xf_used_attr</a>
              </li>
            
          </ul>
        </dd>
      
    </dl>
  

  
    <!-- Includes -->
    <div class="sectiontitle">Included Modules</div>
    <ul>
      
        <li>
          
            <a href="../Internals.html">
              Spreadsheet::Excel::Internals
            </a>
          
        </li>
      
    </ul>
  



  

    

    

    


    
      <!-- Section attributes -->
      <div class="sectiontitle">Attributes</div>
      <table border='0' cellpadding='5'>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>format</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>xf_index</td>
            <td class='attr-desc'></td>
          </tr>
        
      </table>
    


    <!-- Methods -->
    
      <div class="sectiontitle">Class Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-c-boolean">
            
              <a name="method-c-boolean"></a><b>boolean</b>(*args)
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-boolean_source')" id="l_method-c-boolean_source">show</a>
                
              </p>
              <div id="method-c-boolean_source" class="dyn-source">
                <pre><span class="ruby-comment"># File spreadsheet/lib/spreadsheet/excel/writer/format.rb, line 12</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">Format</span>.<span class="ruby-identifier">boolean</span> *<span class="ruby-identifier">args</span>
  <span class="ruby-identifier">args</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">define_method</span> <span class="ruby-identifier">key</span> <span class="ruby-keyword">do</span>
      <span class="ruby-ivar">@format</span>.<span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;#{key}?&quot;</span>) <span class="ruby-operator">?</span> <span class="ruby-number">1</span> <span class="ruby-operator">:</span> <span class="ruby-number">0</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-color">
            
              <a name="method-c-color"></a><b>color</b>(key, default)
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-color_source')" id="l_method-c-color_source">show</a>
                
              </p>
              <div id="method-c-color_source" class="dyn-source">
                <pre><span class="ruby-comment"># File spreadsheet/lib/spreadsheet/excel/writer/format.rb, line 19</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">Format</span>.<span class="ruby-identifier">color</span> <span class="ruby-identifier">key</span>, <span class="ruby-identifier">default</span>
  <span class="ruby-identifier">define_method</span> <span class="ruby-identifier">key</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">color_code</span>(<span class="ruby-ivar">@format</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">key</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">default</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-new">
            
              <a name="method-c-new"></a><b>new</b>(writer, workbook, format=workbook.default_format, opts={})
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-new_source')" id="l_method-c-new_source">show</a>
                
              </p>
              <div id="method-c-new_source" class="dyn-source">
                <pre><span class="ruby-comment"># File spreadsheet/lib/spreadsheet/excel/writer/format.rb, line 35</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">initialize</span> <span class="ruby-identifier">writer</span>, <span class="ruby-identifier">workbook</span>, <span class="ruby-identifier">format</span>=<span class="ruby-identifier">workbook</span>.<span class="ruby-identifier">default_format</span>, <span class="ruby-identifier">opts</span>={}
  <span class="ruby-ivar">@opts</span> = { <span class="ruby-value">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:format</span> }.<span class="ruby-identifier">merge</span> <span class="ruby-identifier">opts</span>
  <span class="ruby-ivar">@format</span> = <span class="ruby-identifier">format</span>
  <span class="ruby-ivar">@writer</span> = <span class="ruby-identifier">writer</span>
  <span class="ruby-ivar">@workbook</span> = <span class="ruby-identifier">workbook</span>
  <span class="ruby-keyword">super</span> <span class="ruby-identifier">format</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
                  
      <div class="sectiontitle">Instance Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-i-color_code">
            
              <a name="method-i-color_code"></a><b>color_code</b>(color)
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-color_code_source')" id="l_method-i-color_code_source">show</a>
                
              </p>
              <div id="method-i-color_code_source" class="dyn-source">
                <pre><span class="ruby-comment"># File spreadsheet/lib/spreadsheet/excel/writer/format.rb, line 42</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">color_code</span> <span class="ruby-identifier">color</span>
  <span class="ruby-constant">SEDOC_ROLOC</span>[<span class="ruby-identifier">color</span>]
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-font_index">
            
              <a name="method-i-font_index"></a><b>font_index</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-font_index_source')" id="l_method-i-font_index_source">show</a>
                
              </p>
              <div id="method-i-font_index_source" class="dyn-source">
                <pre><span class="ruby-comment"># File spreadsheet/lib/spreadsheet/excel/writer/format.rb, line 45</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">font_index</span>
  <span class="ruby-ivar">@writer</span>.<span class="ruby-identifier">font_index</span> <span class="ruby-ivar">@workbook</span>, <span class="ruby-identifier">font</span>.<span class="ruby-identifier">key</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-horizontal_align">
            
              <a name="method-i-horizontal_align"></a><b>horizontal_align</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-horizontal_align_source')" id="l_method-i-horizontal_align_source">show</a>
                
              </p>
              <div id="method-i-horizontal_align_source" class="dyn-source">
                <pre><span class="ruby-comment"># File spreadsheet/lib/spreadsheet/excel/writer/format.rb, line 48</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">horizontal_align</span>
  <span class="ruby-constant">XF_H_ALIGN</span>.<span class="ruby-identifier">fetch</span> <span class="ruby-ivar">@format</span>.<span class="ruby-identifier">horizontal_align</span>, <span class="ruby-number">0</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-num_format">
            
              <a name="method-i-num_format"></a><b>num_format</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-num_format_source')" id="l_method-i-num_format_source">show</a>
                
              </p>
              <div id="method-i-num_format_source" class="dyn-source">
                <pre><span class="ruby-comment"># File spreadsheet/lib/spreadsheet/excel/writer/format.rb, line 51</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">num_format</span>
  <span class="ruby-ivar">@writer</span>.<span class="ruby-identifier">number_format_index</span> <span class="ruby-ivar">@workbook</span>, <span class="ruby-ivar">@format</span>.<span class="ruby-identifier">number_format</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-text_direction">
            
              <a name="method-i-text_direction"></a><b>text_direction</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-text_direction_source')" id="l_method-i-text_direction_source">show</a>
                
              </p>
              <div id="method-i-text_direction_source" class="dyn-source">
                <pre><span class="ruby-comment"># File spreadsheet/lib/spreadsheet/excel/writer/format.rb, line 54</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">text_direction</span>
  <span class="ruby-constant">XF_TEXT_DIRECTION</span>.<span class="ruby-identifier">fetch</span> <span class="ruby-ivar">@format</span>.<span class="ruby-identifier">text_direction</span>, <span class="ruby-number">0</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-vertical_align">
            
              <a name="method-i-vertical_align"></a><b>vertical_align</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-vertical_align_source')" id="l_method-i-vertical_align_source">show</a>
                
              </p>
              <div id="method-i-vertical_align_source" class="dyn-source">
                <pre><span class="ruby-comment"># File spreadsheet/lib/spreadsheet/excel/writer/format.rb, line 57</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">vertical_align</span>
  <span class="ruby-constant">XF_V_ALIGN</span>.<span class="ruby-identifier">fetch</span> <span class="ruby-ivar">@format</span>.<span class="ruby-identifier">vertical_align</span>, <span class="ruby-number">2</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-write_op">
            
              <a name="method-i-write_op"></a><b>write_op</b>(writer, op, *args)
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-write_op_source')" id="l_method-i-write_op_source">show</a>
                
              </p>
              <div id="method-i-write_op_source" class="dyn-source">
                <pre><span class="ruby-comment"># File spreadsheet/lib/spreadsheet/excel/writer/format.rb, line 60</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">write_op</span> <span class="ruby-identifier">writer</span>, <span class="ruby-identifier">op</span>, *<span class="ruby-identifier">args</span>
  <span class="ruby-identifier">data</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">join</span>
  <span class="ruby-identifier">writer</span>.<span class="ruby-identifier">write</span> [<span class="ruby-identifier">op</span>,<span class="ruby-identifier">data</span>.<span class="ruby-identifier">size</span>].<span class="ruby-identifier">pack</span>(<span class="ruby-string">&quot;v2&quot;</span>)
  <span class="ruby-identifier">writer</span>.<span class="ruby-identifier">write</span> <span class="ruby-identifier">data</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-write_xf">
            
              <a name="method-i-write_xf"></a><b>write_xf</b>(writer, type=@opts[:type])
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-write_xf_source')" id="l_method-i-write_xf_source">show</a>
                
              </p>
              <div id="method-i-write_xf_source" class="dyn-source">
                <pre><span class="ruby-comment"># File spreadsheet/lib/spreadsheet/excel/writer/format.rb, line 65</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">write_xf</span> <span class="ruby-identifier">writer</span>, <span class="ruby-identifier">type</span>=<span class="ruby-ivar">@opts</span>[<span class="ruby-value">:type</span>]
  <span class="ruby-identifier">xf_type</span> = <span class="ruby-identifier">xf_type_prot</span> <span class="ruby-identifier">type</span>
  <span class="ruby-identifier">data</span> = [
    <span class="ruby-identifier">font_index</span>,   <span class="ruby-comment"># Index to FONT record (➜ 6.43)</span>
    <span class="ruby-identifier">num_format</span>,   <span class="ruby-comment"># Index to FORMAT record (➜ 6.45)</span>
    <span class="ruby-identifier">xf_type</span>,      <span class="ruby-comment">#  Bit  Mask    Contents</span>
                  <span class="ruby-comment">#  2-0  0x0007  XF_TYPE_PROT – XF type, cell protection</span>
                  <span class="ruby-comment">#               Bit  Mask  Contents</span>
                  <span class="ruby-comment">#                 0  0x01  1 = Cell is locked</span>
                  <span class="ruby-comment">#                 1  0x02  1 = Formula is hidden</span>
                  <span class="ruby-comment">#                 2  0x04  0 = Cell XF; 1 = Style XF</span>
                  <span class="ruby-comment"># 15-4  0xfff0  Index to parent style XF</span>
                  <span class="ruby-comment">#               (always 0xfff in style XFs)</span>
    <span class="ruby-identifier">xf_align</span>,     <span class="ruby-comment">#  Bit  Mask    Contents</span>
                  <span class="ruby-comment">#  2-0  0x07    XF_HOR_ALIGN – Horizontal alignment</span>
                  <span class="ruby-comment">#               Value  Horizontal alignment</span>
                  <span class="ruby-comment">#               0x00   General</span>
                  <span class="ruby-comment">#               0x01   Left</span>
                  <span class="ruby-comment">#               0x02   Centred</span>
                  <span class="ruby-comment">#               0x03   Right</span>
                  <span class="ruby-comment">#               0x04   Filled</span>
                  <span class="ruby-comment">#               0x05   Justified (BIFF4-BIFF8X)</span>
                  <span class="ruby-comment">#               0x06   Centred across selection</span>
                  <span class="ruby-comment">#                      (BIFF4-BIFF8X)</span>
                  <span class="ruby-comment">#               0x07   Distributed (BIFF8X)</span>
                  <span class="ruby-comment">#    3  0x08    1 = Text is wrapped at right border</span>
                  <span class="ruby-comment">#  6-4  0x70    XF_VERT_ALIGN – Vertical alignment</span>
                  <span class="ruby-comment">#               Value  Vertical alignment</span>
                  <span class="ruby-comment">#               0x00   Top</span>
                  <span class="ruby-comment">#               0x01   Centred</span>
                  <span class="ruby-comment">#               0x02   Bottom</span>
                  <span class="ruby-comment">#               0x03   Justified (BIFF5-BIFF8X)</span>
                  <span class="ruby-comment">#               0x04   Distributed (BIFF8X)</span>
    <span class="ruby-identifier">xf_rotation</span>,  <span class="ruby-comment"># XF_ROTATION:  Text rotation angle</span>
                  <span class="ruby-comment">#  Value  Text rotation</span>
                  <span class="ruby-comment">#      0  Not rotated</span>
                  <span class="ruby-comment">#   1-90  1 to 90 degrees counterclockwise</span>
                  <span class="ruby-comment"># 91-180  1 to 90 degrees clockwise</span>
                  <span class="ruby-comment">#    255  Letters are stacked top-to-bottom,</span>
                  <span class="ruby-comment">#         but not rotated</span>
    <span class="ruby-identifier">xf_indent</span>,    <span class="ruby-comment">#  Bit  Mask  Contents</span>
                  <span class="ruby-comment">#  3-0  0x0f  Indent level</span>
                  <span class="ruby-comment">#    4  0x10  1 = Shrink content to fit into cell</span>
                  <span class="ruby-comment">#    5  0x40  1 = Merge Range (djberger)</span>
                  <span class="ruby-comment">#  7-6  0xc0  Text direction (BIFF8X only)</span>
                  <span class="ruby-comment">#             0 = According to context</span>
                  <span class="ruby-comment">#             1 = Left-to-right</span>
                  <span class="ruby-comment">#             2 = Right-to-left</span>
    <span class="ruby-identifier">xf_used_attr</span>, <span class="ruby-comment">#  Bit  Mask  Contents</span>
                  <span class="ruby-comment">#  7-2  0xfc  XF_USED_ATTRIB – Used attributes</span>
                  <span class="ruby-comment">#             Each bit describes the validity of a</span>
                  <span class="ruby-comment">#             specific group of attributes. In cell XFs</span>
                  <span class="ruby-comment">#             a cleared bit means the attributes of the</span>
                  <span class="ruby-comment">#             parent style XF are used (but only if the</span>
                  <span class="ruby-comment">#             attributes are valid there), a set bit</span>
                  <span class="ruby-comment">#             means the attributes of this XF are used.</span>
                  <span class="ruby-comment">#             In style XFs a cleared bit means the</span>
                  <span class="ruby-comment">#             attribute setting is valid, a set bit</span>
                  <span class="ruby-comment">#             means the attribute should be ignored.</span>
                  <span class="ruby-comment">#             Bit  Mask  Contents</span>
                  <span class="ruby-comment">#               0  0x01  Flag for number format</span>
                  <span class="ruby-comment">#               1  0x02  Flag for font</span>
                  <span class="ruby-comment">#               2  0x04  Flag for horizontal and</span>
                  <span class="ruby-comment">#                        vertical alignment, text wrap,</span>
                  <span class="ruby-comment">#                        indentation, orientation,</span>
                  <span class="ruby-comment">#                        rotation, and text direction</span>
                  <span class="ruby-comment">#               3  0x08  Flag for border lines</span>
                  <span class="ruby-comment">#               4  0x10  Flag for background area style</span>
                  <span class="ruby-comment">#               5  0x20  Flag for cell protection (cell</span>
                  <span class="ruby-comment">#                        locked and formula hidden)</span>
    <span class="ruby-identifier">xf_borders</span>,   <span class="ruby-comment"># Cell border lines and background area:</span>
                  <span class="ruby-comment">#   Bit  Mask        Contents</span>
                  <span class="ruby-comment">#  3- 0  0x0000000f  Left line style (➜ 3.10)</span>
                  <span class="ruby-comment">#  7- 4  0x000000f0  Right line style (➜ 3.10)</span>
                  <span class="ruby-comment"># 11- 8  0x00000f00  Top line style (➜ 3.10)</span>
                  <span class="ruby-comment"># 15-12  0x0000f000  Bottom line style (➜ 3.10)</span>
                  <span class="ruby-comment"># 22-16  0x007f0000  Colour index (➜ 6.70)</span>
                  <span class="ruby-comment">#                    for left line colour</span>
                  <span class="ruby-comment"># 29-23  0x3f800000  Colour index (➜ 6.70)</span>
                  <span class="ruby-comment">#                    for right line colour</span>
                  <span class="ruby-comment">#    30  0x40000000  1 = Diagonal line</span>
                  <span class="ruby-comment">#                    from top left to right bottom</span>
                  <span class="ruby-comment">#    31  0x80000000  1 = Diagonal line</span>
                  <span class="ruby-comment">#                    from bottom left to right top</span>
    <span class="ruby-identifier">xf_brdcolors</span>, <span class="ruby-comment">#   Bit  Mask        Contents</span>
                  <span class="ruby-comment">#  6- 0  0x0000007f  Colour index (➜ 6.70)</span>
                  <span class="ruby-comment">#                    for top line colour</span>
                  <span class="ruby-comment"># 13- 7  0x00003f80  Colour index (➜ 6.70)</span>
                  <span class="ruby-comment">#                    for bottom line colour</span>
                  <span class="ruby-comment"># 20-14  0x001fc000  Colour index (➜ 6.70)</span>
                  <span class="ruby-comment">#                    for diagonal line colour</span>
                  <span class="ruby-comment"># 24-21  0x01e00000  Diagonal line style (➜ 3.10)</span>
                  <span class="ruby-comment"># 31-26  0xfc000000  Fill pattern (➜ 3.11)</span>
    <span class="ruby-identifier">xf_pattern</span>    <span class="ruby-comment">#   Bit  Mask        Contents</span>
                  <span class="ruby-comment">#   6-0  0x007f      Colour index (➜ 6.70)</span>
                  <span class="ruby-comment">#                    for pattern colour</span>
                  <span class="ruby-comment">#  13-7  0x3f80      Colour index (➜ 6.70)</span>
                  <span class="ruby-comment">#                    for pattern background</span>
  ]
  <span class="ruby-identifier">write_op</span> <span class="ruby-identifier">writer</span>, <span class="ruby-number">0x00e0</span>, <span class="ruby-identifier">data</span>.<span class="ruby-identifier">pack</span>(<span class="ruby-identifier">binfmt</span>(<span class="ruby-value">:xf</span>))
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-xf_align">
            
              <a name="method-i-xf_align"></a><b>xf_align</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-xf_align_source')" id="l_method-i-xf_align_source">show</a>
                
              </p>
              <div id="method-i-xf_align_source" class="dyn-source">
                <pre><span class="ruby-comment"># File spreadsheet/lib/spreadsheet/excel/writer/format.rb, line 166</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">xf_align</span>
  <span class="ruby-identifier">align</span> = <span class="ruby-identifier">horizontal_align</span>
  <span class="ruby-identifier">align</span> <span class="ruby-operator">|=</span> <span class="ruby-identifier">text_wrap</span>      <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-number">3</span>
  <span class="ruby-identifier">align</span> <span class="ruby-operator">|=</span> <span class="ruby-identifier">vertical_align</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-number">4</span>
  <span class="ruby-identifier">align</span> <span class="ruby-operator">|=</span> <span class="ruby-identifier">text_justlast</span>  <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-number">7</span>
  <span class="ruby-identifier">align</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-xf_borders">
            
              <a name="method-i-xf_borders"></a><b>xf_borders</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-xf_borders_source')" id="l_method-i-xf_borders_source">show</a>
                
              </p>
              <div id="method-i-xf_borders_source" class="dyn-source">
                <pre><span class="ruby-comment"># File spreadsheet/lib/spreadsheet/excel/writer/format.rb, line 173</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">xf_borders</span>
  <span class="ruby-identifier">border</span>  = <span class="ruby-identifier">left</span>
  <span class="ruby-identifier">border</span> <span class="ruby-operator">|=</span> <span class="ruby-identifier">right</span>       <span class="ruby-operator">&lt;&lt;</span>  <span class="ruby-number">4</span>
  <span class="ruby-identifier">border</span> <span class="ruby-operator">|=</span> <span class="ruby-identifier">top</span>         <span class="ruby-operator">&lt;&lt;</span>  <span class="ruby-number">8</span>
  <span class="ruby-identifier">border</span> <span class="ruby-operator">|=</span> <span class="ruby-identifier">bottom</span>      <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-number">12</span>
  <span class="ruby-identifier">border</span> <span class="ruby-operator">|=</span> <span class="ruby-identifier">left_color</span>  <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-number">16</span>
  <span class="ruby-identifier">border</span> <span class="ruby-operator">|=</span> <span class="ruby-identifier">right_color</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-number">23</span>
  <span class="ruby-identifier">border</span> <span class="ruby-operator">|=</span> <span class="ruby-identifier">cross_down</span>  <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-number">30</span>
  <span class="ruby-identifier">border</span> <span class="ruby-operator">|=</span> <span class="ruby-identifier">cross_up</span>    <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-number">31</span>
  <span class="ruby-identifier">border</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-xf_brdcolors">
            
              <a name="method-i-xf_brdcolors"></a><b>xf_brdcolors</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-xf_brdcolors_source')" id="l_method-i-xf_brdcolors_source">show</a>
                
              </p>
              <div id="method-i-xf_brdcolors_source" class="dyn-source">
                <pre><span class="ruby-comment"># File spreadsheet/lib/spreadsheet/excel/writer/format.rb, line 184</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">xf_brdcolors</span>
  <span class="ruby-identifier">border</span>  = <span class="ruby-identifier">top_color</span>
  <span class="ruby-identifier">border</span> <span class="ruby-operator">|=</span> <span class="ruby-identifier">bottom_color</span>   <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-number">7</span>
  <span class="ruby-identifier">border</span> <span class="ruby-operator">|=</span> <span class="ruby-identifier">diagonal_color</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-number">14</span>
  <span class="ruby-identifier">border</span> <span class="ruby-operator">|=</span> <span class="ruby-identifier">pattern</span>        <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-number">26</span>
  <span class="ruby-identifier">border</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-xf_indent">
            
              <a name="method-i-xf_indent"></a><b>xf_indent</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-xf_indent_source')" id="l_method-i-xf_indent_source">show</a>
                
              </p>
              <div id="method-i-xf_indent_source" class="dyn-source">
                <pre><span class="ruby-comment"># File spreadsheet/lib/spreadsheet/excel/writer/format.rb, line 191</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">xf_indent</span>
  <span class="ruby-identifier">indent</span>  = <span class="ruby-identifier">indent_level</span> &amp; <span class="ruby-number">0x0f</span>
  <span class="ruby-identifier">indent</span> <span class="ruby-operator">|=</span> <span class="ruby-identifier">shrink</span>         <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-number">4</span>
  <span class="ruby-identifier">indent</span> <span class="ruby-operator">|=</span> <span class="ruby-identifier">merge_range</span>    <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-number">5</span>
  <span class="ruby-identifier">indent</span> <span class="ruby-operator">|=</span> <span class="ruby-identifier">text_direction</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-number">6</span>
  <span class="ruby-identifier">indent</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-xf_pattern">
            
              <a name="method-i-xf_pattern"></a><b>xf_pattern</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-xf_pattern_source')" id="l_method-i-xf_pattern_source">show</a>
                
              </p>
              <div id="method-i-xf_pattern_source" class="dyn-source">
                <pre><span class="ruby-comment"># File spreadsheet/lib/spreadsheet/excel/writer/format.rb, line 198</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">xf_pattern</span>
  <span class="ruby-identifier">ptrn</span>  = <span class="ruby-identifier">pattern_fg_color</span>
  <span class="ruby-identifier">ptrn</span> <span class="ruby-operator">|=</span> <span class="ruby-identifier">pattern_bg_color</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-number">7</span>
  <span class="ruby-identifier">ptrn</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-xf_rotation">
            
              <a name="method-i-xf_rotation"></a><b>xf_rotation</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-xf_rotation_source')" id="l_method-i-xf_rotation_source">show</a>
                
              </p>
              <div id="method-i-xf_rotation_source" class="dyn-source">
                <pre><span class="ruby-comment"># File spreadsheet/lib/spreadsheet/excel/writer/format.rb, line 203</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">xf_rotation</span>
  <span class="ruby-identifier">rot</span> = <span class="ruby-ivar">@format</span>.<span class="ruby-identifier">rotation</span>
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@format</span>.<span class="ruby-identifier">rotation_stacked?</span>
    <span class="ruby-identifier">rot</span> = <span class="ruby-number">255</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">rot</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-number">-90</span> <span class="ruby-keyword">or</span> <span class="ruby-identifier">rotation</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-number">90</span>
    <span class="ruby-identifier">rot</span> = <span class="ruby-operator">-</span><span class="ruby-identifier">rot</span> <span class="ruby-operator">+</span> <span class="ruby-number">90</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">rot</span> <span class="ruby-operator">&lt;</span> <span class="ruby-number">0</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">warn</span> <span class="ruby-string">&quot;rotation outside -90..90; rotation set to 0&quot;</span>
    <span class="ruby-identifier">rot</span> = <span class="ruby-number">0</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">rot</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-xf_type_prot">
            
              <a name="method-i-xf_type_prot"></a><b>xf_type_prot</b>(type)
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-xf_type_prot_source')" id="l_method-i-xf_type_prot_source">show</a>
                
              </p>
              <div id="method-i-xf_type_prot_source" class="dyn-source">
                <pre><span class="ruby-comment"># File spreadsheet/lib/spreadsheet/excel/writer/format.rb, line 215</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">xf_type_prot</span> <span class="ruby-identifier">type</span>
  <span class="ruby-identifier">type</span> = <span class="ruby-identifier">type</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">downcase</span> <span class="ruby-operator">==</span> <span class="ruby-string">'style'</span> <span class="ruby-operator">?</span> <span class="ruby-number">0xfff5</span> <span class="ruby-operator">:</span> <span class="ruby-number">0x0000</span>
  <span class="ruby-identifier">type</span> <span class="ruby-operator">|=</span> <span class="ruby-identifier">locked</span>
  <span class="ruby-identifier">type</span> <span class="ruby-operator">|=</span> <span class="ruby-identifier">hidden</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-number">1</span>
  <span class="ruby-identifier">type</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-xf_used_attr">
            
              <a name="method-i-xf_used_attr"></a><b>xf_used_attr</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-xf_used_attr_source')" id="l_method-i-xf_used_attr_source">show</a>
                
              </p>
              <div id="method-i-xf_used_attr_source" class="dyn-source">
                <pre><span class="ruby-comment"># File spreadsheet/lib/spreadsheet/excel/writer/format.rb, line 221</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">xf_used_attr</span>
  <span class="ruby-identifier">atr_num</span> = <span class="ruby-identifier">num_format</span> &amp; <span class="ruby-number">1</span>
  <span class="ruby-identifier">atr_fnt</span> = <span class="ruby-identifier">font_index</span> &amp; <span class="ruby-number">1</span>
  <span class="ruby-identifier">atr_fnt</span> = <span class="ruby-number">1</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@format</span>.<span class="ruby-identifier">font</span>.<span class="ruby-identifier">color</span> <span class="ruby-operator">==</span> <span class="ruby-value">:text</span>
  <span class="ruby-identifier">atr_alc</span> = <span class="ruby-number">0</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">horizontal_align</span> <span class="ruby-operator">!=</span> <span class="ruby-number">0</span>        <span class="ruby-operator">||</span> <span class="ruby-identifier">vertical_align</span> <span class="ruby-operator">!=</span> <span class="ruby-number">2</span>        <span class="ruby-operator">||</span> <span class="ruby-identifier">indent_level</span> <span class="ruby-operator">&gt;</span> <span class="ruby-number">0</span>        <span class="ruby-operator">||</span> <span class="ruby-identifier">shrink?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">merge_range?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">text_wrap?</span>
  <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">atr_alc</span> = <span class="ruby-number">1</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">atr_bdr</span> = [<span class="ruby-identifier">top</span>, <span class="ruby-identifier">bottom</span>, <span class="ruby-identifier">left</span>, <span class="ruby-identifier">right</span>, <span class="ruby-identifier">cross_up</span>, <span class="ruby-identifier">cross_down</span>].<span class="ruby-identifier">max</span>
  <span class="ruby-identifier">atr_pat</span> = <span class="ruby-number">0</span>
  <span class="ruby-keyword">if</span>  <span class="ruby-ivar">@format</span>.<span class="ruby-identifier">pattern_fg_color</span> <span class="ruby-operator">!=</span> <span class="ruby-value">:border</span>        <span class="ruby-operator">||</span> <span class="ruby-ivar">@format</span>.<span class="ruby-identifier">pattern_bg_color</span> <span class="ruby-operator">!=</span> <span class="ruby-value">:pattern_bg</span>        <span class="ruby-operator">||</span> <span class="ruby-identifier">pattern</span> <span class="ruby-operator">!=</span> <span class="ruby-number">0x00</span>
  <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">atr_pat</span> = <span class="ruby-number">1</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">atr_prot</span> = <span class="ruby-identifier">hidden?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">locked?</span> <span class="ruby-operator">?</span> <span class="ruby-number">1</span> <span class="ruby-operator">:</span> <span class="ruby-number">0</span>
  <span class="ruby-identifier">attrs</span>  = <span class="ruby-identifier">atr_num</span>
  <span class="ruby-identifier">attrs</span> <span class="ruby-operator">|=</span> <span class="ruby-identifier">atr_fnt</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-number">1</span>
  <span class="ruby-identifier">attrs</span> <span class="ruby-operator">|=</span> <span class="ruby-identifier">atr_alc</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-number">2</span>
  <span class="ruby-identifier">attrs</span> <span class="ruby-operator">|=</span> <span class="ruby-identifier">atr_bdr</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-number">3</span>
  <span class="ruby-identifier">attrs</span> <span class="ruby-operator">|=</span> <span class="ruby-identifier">atr_pat</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-number">4</span>
  <span class="ruby-identifier">attrs</span> <span class="ruby-operator">|=</span> <span class="ruby-identifier">atr_prot</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-number">5</span>
  <span class="ruby-identifier">attrs</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-number">2</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
                    </div>
    </div>
  </body>
</html>    